package model

import (
	"time"

	"github.com/google/uuid"
)

type Vulnerability struct {
	ID             uuid.UUID  `json:"id" db:"id"`
	CVEID          string     `json:"cve_id" db:"cve_id"`
	Description    string     `json:"description" db:"description"`
	Severity       string     `json:"severity" db:"severity"`
	CVSSScore      float64    `json:"cvss_score" db:"cvss_score"`
	EPSSScore      *float64   `json:"epss_score,omitempty" db:"epss_score"`
	EPSSPercentile *float64   `json:"epss_percentile,omitempty" db:"epss_percentile"`
	EPSSUpdatedAt  *time.Time `json:"epss_updated_at,omitempty" db:"epss_updated_at"`
	Source         string     `json:"source" db:"source"` // NVD or JVN
	PublishedAt    time.Time  `json:"published_at" db:"published_at"`
	UpdatedAt      time.Time  `json:"updated_at" db:"updated_at"`
}

type ComponentVulnerability struct {
	ComponentID     uuid.UUID `json:"component_id" db:"component_id"`
	VulnerabilityID uuid.UUID `json:"vulnerability_id" db:"vulnerability_id"`
	DetectedAt      time.Time `json:"detected_at" db:"detected_at"`
}

type Severity string

const (
	SeverityCritical Severity = "CRITICAL"
	SeverityHigh     Severity = "HIGH"
	SeverityMedium   Severity = "MEDIUM"
	SeverityLow      Severity = "LOW"
)
